<template>
    <lightning-spinner alternative-text="Loading" if:true={isSpinner} size="small" variant="brand"></lightning-spinner>
    <div class="c-container">
        <div style="text-align: center; " lwc:if={docId}>
            Thank You.
        </div>
        <div style="text-align: center; " lwc:else>
            <h2 class="slds-text-heading_medium slds-var-m-bottom_medium">
                Please Provide Your Signature:
            </h2>
            
            <!-- Mode Selection -->
            <div class="slds-var-m-bottom_medium">
                <lightning-radio-group 
                    name="signatureMode" 
                    options={modeOptions} 
                    value={signatureMode} 
                    onchange={handleModeChange}
                    type="button">
                </lightning-radio-group>
            </div>

            <!-- Draw Mode -->
            <template if:true={isDrawMode}>
                <!-- Canvas for drawing -->
                <div class="slds-var-m-bottom_small">
                    <canvas name="canvasItem" style="border:2px solid rgb(136, 135, 135); background: transparent;"></canvas>
                </div>
                <!-- Draw Mode Instructions -->
                <div class="slds-var-m-bottom_small signature-instructions">
                    <lightning-icon icon-name="utility:touch_action" size="x-small"></lightning-icon>
                    <span class="slds-p-left_x-small">Use your mouse to draw your signature above</span>
                </div>
            </template>

            <!-- Upload Mode -->
            <template if:true={isUploadMode}>
                <div class="slds-var-m-bottom_medium">
                    <div class="signature-instructions slds-var-m-bottom_small">
                        <lightning-icon icon-name="utility:upload" size="x-small"></lightning-icon>
                        <span class="slds-p-left_x-small">Upload your signature image (PNG or JPG only)</span>
                    </div>
                    <input 
                        type="file" 
                        accept=".png,.jpg,.jpeg,image/png,image/jpeg" 
                        onchange={handleFileUpload}
                        class="file-upload-input">
                    
                    <!-- Preview canvas for uploaded image -->
                    <template if:true={uploadedImageData}>
                        <div class="slds-var-m-top_small">
                            <div class="signature-preview-label">Signature Preview:</div>
                            <canvas name="canvasItem" style="border:2px solid rgb(136, 135, 135); background: transparent;"></canvas>
                        </div>
                    </template>
                </div>
            </template>

            <!-- Action Buttons -->
            <div class="slds-var-m-bottom_small">
                <lightning-button 
                    variant="brand" 
                    label="Capture Signature" 
                    title="Capture Signature" 
                    onclick={handleSaveClick} 
                    disabled={isButtonDisabled}
                    class="slds-var-m-left_x-small">
                </lightning-button>
                <lightning-button 
                    variant="destructive" 
                    label="Clear" 
                    title="Clear" 
                    onclick={handleClearClick} 
                    class="slds-var-m-left_x-small">
                </lightning-button>
            </div>
        </div>
    </div>
</template>